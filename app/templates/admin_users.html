{% extends "base.html" %}

{% block title %}Manage Users{% endblock %}
{% block content %}
<div class="manage-container">

    <!-- Header -->
    <h1 class="page-title"><i class="fa fa-users-cog"></i> Manage Users</h1>

    <!-- Action Buttons -->
    <div class="action-buttons">
        <a href="{{ url_for('admin_add_user') }}" class="btn btn-primary-custom">
            <i class="fa fa-user-plus"></i> Add User
        </a>
    </div>

    <!-- Students Section -->
    <div class="card">
        <div class="card-header student-header">
            <h2><i class="fa fa-user-graduate"></i> Students</h2>
        </div>
        <div class="card-body">
            {% if students %}
            <div class="table-wrapper">
                <table class="styled-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Student Number</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for student in students %}
                        <tr>
                            <td>{{ student.full_name }}</td>
                            <td>{{ student.email or 'N/A' }}</td>
                            <td>{{ student.student_number or 'N/A' }}</td>
                            <td class="action-buttons">
                                <a href="{{ url_for('admin_edit_user', user_id=student.user_id) }}" class="btn edit"><i class="fa fa-edit"></i> Edit</a>
                                <form method="POST" action="{{ url_for('admin_delete_user', user_id=student.user_id) }}" onsubmit="return confirm('Are you sure you want to delete this student?');">
                                    <button type="submit" class="btn delete"><i class="fa fa-trash"></i> Delete</button>
                                </form>
                                <a href="{{ url_for('admin_reset_password', user_id=student.user_id) }}" class="btn reset"><i class="fa fa-key"></i> Reset</a>
                                <a href="{{ url_for('admin_enroll_student_in_modules', student_id=student.user_id) }}" class="btn enroll"><i class="fa fa-book"></i> Enroll</a>
                                <a href="{{ url_for('admin_student_enrollments', student_id=student.user_id) }}" class="btn view"><i class="fa fa-eye"></i> View</a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <p class="empty-text">No students found.</p>
            {% endif %}
        </div>
    </div>

    <!-- Lecturers Section -->
    <div class="card">
        <div class="card-header lecturer-header">
            <h2><i class="fa fa-chalkboard-teacher"></i> Lecturers</h2>
        </div>
        <div class="card-body">
            {% if lecturers %}
            <div class="table-wrapper">
                <table class="styled-table">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Email</th>
                            <th>Username</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for lecturer in lecturers %}
                        <tr>
                            <td>{{ lecturer.full_name }}</td>
                            <td>{{ lecturer.email or 'N/A' }}</td>
                            <td>{{ lecturer.username or 'N/A' }}</td>
                            <td class="action-buttons">
                                <a href="{{ url_for('admin_edit_user', user_id=lecturer.user_id) }}" class="btn edit"><i class="fa fa-edit"></i> Edit</a>
                                <form method="POST" action="{{ url_for('admin_delete_user', user_id=lecturer.user_id) }}" onsubmit="return confirm('Are you sure you want to delete this lecturer?');">
                                    <button type="submit" class="btn delete"><i class="fa fa-trash"></i> Delete</button>
                                </form>
                                <a href="{{ url_for('admin_reset_password', user_id=lecturer.user_id) }}" class="btn reset"><i class="fa fa-key"></i> Reset</a>
                                <a href="{{ url_for('admin_assign_modules_to_lecturer', lecturer_id=lecturer.user_id) }}" class="btn assign"><i class="fa fa-tasks"></i> Assign</a>
                                <a href="{{ url_for('admin_lecturer_assignments', lecturer_id=lecturer.user_id) }}" class="btn view"><i class="fa fa-eye"></i> View</a>
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
            {% else %}
            <p class="empty-text">No lecturers found.</p>
            {% endif %}
        </div>
    </div>
</div>

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css" integrity="sha512-dzFZK5FL4+JwPTZOSY6mPpBZ/wgT8nYhkq0q5NQe1+8hC1u1JXvM4i2t1VRZMgMF8c6uQ6UEkGgF5m3iGqdtZQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />

<style>
.manage-container { 
    max-width: 1200px; 
    margin: auto; 
    padding: 20px; 
}
.page-title { 
    font-size: 28px; 
    margin-bottom: 20px; 
    color: #333; 
}

.action-buttons {
    display: flex;
    gap: 15px;
    margin-bottom: 25px;
    flex-wrap: wrap;
}

.btn-primary-custom, .btn-secondary-custom {
    display: inline-flex;
    align-items: center;
    gap: 8px;
    padding: 12px 20px;
    border-radius: 8px;
    text-decoration: none;
    font-weight: 500;
    transition: all 0.3s ease;
    border: none;
    cursor: pointer;
    font-size: 1rem;
}

.btn-primary-custom {
    background: linear-gradient(135deg, #1976d2 0%, #42a5f5 100%);
    color: white;
}

.btn-secondary-custom {
    background: linear-gradient(135deg, #6c757d 0%, #8e9ba7 100%);
    color: white;
}

.btn-primary-custom:hover, .btn-secondary-custom:hover {
    transform: translateY(-2px);
    box-shadow: 0 6px 15px rgba(0,0,0,0.2);
}

.flash { 
    padding: 12px; 
    margin-bottom: 15px; 
    border-radius: 6px; 
}
.flash.success { 
    background: #d4edda; 
    color: #155724; 
}
.flash.error { 
    background: #f8d7da; 
    color: #721c24; 
}
.flash.warning { 
    background: #fff3cd; 
    color: #856404; 
}
.card { 
    background: #fff; 
    border-radius: 8px; 
    margin-bottom: 25px; 
    box-shadow: 0 3px 6px rgba(0,0,0,0.1); 
}
.card-header { 
    padding: 12px 20px; 
    border-radius: 8px 8px 0 0; 
    color: #fff; 
}
.student-header { 
    background: #007bff; 
}
.lecturer-header { 
    background: #28a745; 
}
.card-body { 
    padding: 20px; 
}
.styled-table { 
    width: 100%; 
    border-collapse: collapse; 
}
.styled-table thead { 
    background: #333; 
    color: #fff; 
}
.styled-table th, .styled-table td { 
    padding: 12px; 
    text-align: left; 
    border-bottom: 1px solid #ddd; 
}

.styled-table thead tr:hover { 
    background: #333; 
}

.styled-table tbody tr:hover { 
    background: #f5f5f5; 
}

.action-buttons { 
    display: flex; 
    flex-wrap: wrap; 
    gap: 6px; 
}
.btn { 
    padding: 6px 10px; 
    font-size: 14px; 
    border-radius: 4px; 
    text-decoration: none; 
    color: #fff; 
    display: inline-flex; 
    align-items: center; 
    gap: 5px; 
    border: none; 
    cursor: pointer;
}
.btn.edit { 
    background: #007bff; 
}
.btn.delete { 
    background: #dc3545; 
}
.btn.reset { 
    background: #ffc107; 
    color: #333; 
}
.btn.enroll, .btn.assign { 
    background: #17a2b8; 
}
.btn.view { 
    background: #6c757d; 
}
.btn:hover { 
    opacity: 0.9;
}

.empty-text { 
    text-align: center; 
    padding: 20px; 
    color: #777; 
}

@media (max-width: 768px) {
    .action-buttons {
        flex-direction: column;
        align-items: flex-start;
    }
    
    .btn-primary-custom, .btn-secondary-custom {
        width: 100%;
        justify-content: center;
    }
}
</style>
{% endblock %}